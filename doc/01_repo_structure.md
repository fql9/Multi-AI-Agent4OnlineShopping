# 01ï½œä»“åº“ç»“æ„ï¼ˆè½åœ°ç‰ˆï¼šPython Agent + TypeScript API + Monorepoï¼‰

> æœ¬æ–‡æ¡£ç»™å‡ºä¸€ä¸ª**å¯ç›´æ¥ç…§æŠ„åˆ›å»º**çš„ç›®å½•ç»“æ„ï¼Œå›´ç»•"Contract First + Python Agent + TypeScript API"ç»„ç»‡ã€‚

---

## æ ¸å¿ƒåŸåˆ™

1. **Python åš Agent ç¼–æ’**ï¼šLangGraph + Pydantic + FastAPIï¼ŒLLM ç”Ÿæ€æ›´æˆç†Ÿ
2. **TypeScript åš Tool Gateway / MCP**ï¼šå¼ºç±»å‹ APIï¼Œå‰åç«¯ä¸€è‡´
3. **Contract First**ï¼šæ‰€æœ‰å·¥å…·å…ˆå®šä¹‰ schemaï¼ŒPython/TypeScript å„è‡ªç”Ÿæˆ typesafe client
4. **Monorepo**ï¼šä¾¿äº Contract å…±äº«ä¸ä¸€è‡´æ€§æ ¡éªŒ

---

## ç›®å½•æ ‘ï¼ˆå½“å‰å®ç°ï¼‰

```
/
â”œâ”€â”€ README.md                         # é¡¹ç›®ä¸»æ–‡æ¡£
â”œâ”€â”€ CONTRIBUTING.md                   # è´¡çŒ®æŒ‡å—
â”œâ”€â”€ LICENSE                          # è®¸å¯è¯ (GPLv3)
â”œâ”€â”€ SECURITY.md                      # å®‰å…¨æ”¿ç­–
â”‚
â”œâ”€â”€ doc/                             # ğŸ”´ è®¾è®¡ä¸è§„èŒƒæ–‡æ¡£
â”‚   â”œâ”€â”€ README.md                    # æ–‡æ¡£ç´¢å¼•
â”‚   â”œâ”€â”€ 00_overview.md              # é¡¹ç›®æ¦‚è§ˆ
â”‚   â”œâ”€â”€ 01_repo_structure.md        # ä»“åº“ç»“æ„ï¼ˆæœ¬æ–‡æ¡£ï¼‰
â”‚   â”œâ”€â”€ 02_tech_stack.md            # æŠ€æœ¯æ ˆ
â”‚   â”œâ”€â”€ ...
â”‚   â”œâ”€â”€ 17_progress.md              # å¼€å‘è¿›åº¦
â”‚   â””â”€â”€ 18_deployment.md            # éƒ¨ç½²æŒ‡å—
â”‚
â”œâ”€â”€ contracts/                       # ğŸ”´ æ ¸å¿ƒï¼šContract First
â”‚   â”œâ”€â”€ json-schema/                 # å…±äº« JSON Schema
â”‚   â”‚   â””â”€â”€ models/
â”‚   â”‚       â”œâ”€â”€ envelope.schema.json # ç»Ÿä¸€è¯·æ±‚/å“åº” Envelope
â”‚   â”‚       â””â”€â”€ mission.schema.json  # Mission æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ error-codes.yaml             # ç»Ÿä¸€é”™è¯¯ç å®šä¹‰
â”‚
â”œâ”€â”€ packages/                        # å…±äº«åŒ…ï¼ˆTypeScriptï¼‰
â”‚   â””â”€â”€ common/                      # æ—¥å¿—ã€é”™è¯¯ç ã€Envelopeã€traceã€é‡è¯•
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ db.ts               # æ•°æ®åº“è¿æ¥æ± 
â”‚       â”‚   â”œâ”€â”€ envelope.ts         # Envelope å·¥å…·
â”‚       â”‚   â”œâ”€â”€ errors.ts           # é”™è¯¯å¤„ç†
â”‚       â”‚   â”œâ”€â”€ logger.ts           # ç»“æ„åŒ–æ—¥å¿—
â”‚       â”‚   â”œâ”€â”€ retry.ts            # ğŸ†• é‡è¯•/ç†”æ–­/è¶…æ—¶
â”‚       â”‚   â”œâ”€â”€ trace.ts            # OpenTelemetry
â”‚       â”‚   â””â”€â”€ index.ts
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ agents/                          # ğŸ Pythonï¼šAgent ç¼–æ’å±‚
â”‚   â”œâ”€â”€ pyproject.toml               # Python é¡¹ç›®é…ç½®
â”‚   â”œâ”€â”€ Dockerfile                   # Docker é•œåƒ
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ config.py               # Pydantic Settings é…ç½®
â”‚   â”‚   â”œâ”€â”€ server.py               # ğŸ†• FastAPI HTTP Server
â”‚   â”‚   â”œâ”€â”€ main.py                 # CLI å…¥å£
â”‚   â”‚   â”œâ”€â”€ cli.py                  # å‘½ä»¤è¡Œå·¥å…·
â”‚   â”‚   â”œâ”€â”€ graph/                  # LangGraph çŠ¶æ€æœº
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ builder.py          # çŠ¶æ€æœºæ„å»º
â”‚   â”‚   â”‚   â””â”€â”€ state.py            # AgentState å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ orchestrator/           # Orchestrator Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ session.py          # ä¼šè¯ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ intent/                 # Intent Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ node.py
â”‚   â”‚   â”œâ”€â”€ candidate/              # Candidate Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ node.py
â”‚   â”‚   â”œâ”€â”€ verifier/               # Verifier Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ node.py
â”‚   â”‚   â”œâ”€â”€ compliance/             # Compliance Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ node.py
â”‚   â”‚   â”œâ”€â”€ execution/              # Execution/Payment Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ plan_node.py
â”‚   â”‚   â”‚   â”œâ”€â”€ execution_node.py
â”‚   â”‚   â”‚   â””â”€â”€ payment_node.py
â”‚   â”‚   â”œâ”€â”€ tools/                  # LangChain Tools å°è£…
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py             # åŸºç¡€å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ catalog.py          # Catalog å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ pricing.py          # Pricing å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ shipping.py         # Shipping å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ compliance.py       # Compliance å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ checkout.py         # Checkout å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ evidence.py         # Evidence å·¥å…·
â”‚   â”‚   â”‚   â””â”€â”€ knowledge.py        # ğŸ†• Knowledge/RAG å·¥å…·
â”‚   â”‚   â”œâ”€â”€ models/                 # Pydantic æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ mission.py
â”‚   â”‚   â”‚   â”œâ”€â”€ draft_order.py
â”‚   â”‚   â”‚   â””â”€â”€ evidence.py
â”‚   â”‚   â””â”€â”€ llm/                    # LLM å®¢æˆ·ç«¯
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ client.py           # OpenAI API å°è£…
â”‚   â”‚       â”œâ”€â”€ prompts.py          # Agent æç¤ºè¯
â”‚   â”‚       â””â”€â”€ schemas.py          # è¾“å‡º Schema
â”‚   â””â”€â”€ tests/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ test_agent_flow.py
â”‚       â””â”€â”€ test_models.py
â”‚
â”œâ”€â”€ apps/                            # ğŸŸ¦ TypeScriptï¼šAPI / MCP / å‰ç«¯
â”‚   â”œâ”€â”€ tool-gateway/                # ç»Ÿä¸€ Tool Gateway
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ index.ts            # Fastify å…¥å£
â”‚   â”‚       â”œâ”€â”€ config.ts           # é…ç½®
â”‚   â”‚       â”œâ”€â”€ middleware/
â”‚   â”‚       â”‚   â”œâ”€â”€ audit.ts        # å®¡è®¡æ—¥å¿—
â”‚   â”‚       â”‚   â”œâ”€â”€ envelope.ts     # Envelope æ ¡éªŒ
â”‚   â”‚       â”‚   â””â”€â”€ idempotency.ts  # å¹‚ç­‰æ€§
â”‚   â”‚       â”œâ”€â”€ routes/
â”‚   â”‚       â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚       â”‚   â”œâ”€â”€ catalog.ts
â”‚   â”‚       â”‚   â”œâ”€â”€ pricing.ts
â”‚   â”‚       â”‚   â”œâ”€â”€ shipping.ts
â”‚   â”‚       â”‚   â”œâ”€â”€ compliance.ts
â”‚   â”‚       â”‚   â”œâ”€â”€ checkout.ts
â”‚   â”‚       â”‚   â”œâ”€â”€ evidence.ts
â”‚   â”‚       â”‚   â””â”€â”€ knowledge.ts    # ğŸ†• Knowledge è·¯ç”±
â”‚   â”‚       â””â”€â”€ services/
â”‚   â”‚           â””â”€â”€ xoobay.ts       # ğŸ†• XOOBAY API å®¢æˆ·ç«¯
â”‚   â”‚
â”‚   â”œâ”€â”€ mcp-servers/                 # MCP Servers (SSE æ¨¡å¼)
â”‚   â”‚   â”œâ”€â”€ core-mcp/                # æ ¸å¿ƒå·¥å…·æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚   â”‚       â”œâ”€â”€ index.ts        # SSE Server å…¥å£
â”‚   â”‚   â”‚       â”œâ”€â”€ db.ts           # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”‚       â”œâ”€â”€ catalog/
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ pricing/
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ shipping/
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ compliance/
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ tax/
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚       â””â”€â”€ knowledge/      # ğŸ†• RAG å·¥å…·
â”‚   â”‚   â”‚           â””â”€â”€ index.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ checkout-mcp/            # é«˜æ•æ„Ÿï¼šç»“ç®—æœåŠ¡
â”‚   â”‚       â”œâ”€â”€ Dockerfile
â”‚   â”‚       â”œâ”€â”€ package.json
â”‚   â”‚       â”œâ”€â”€ tsconfig.json
â”‚   â”‚       â””â”€â”€ src/
â”‚   â”‚           â”œâ”€â”€ index.ts        # SSE Server å…¥å£
â”‚   â”‚           â”œâ”€â”€ cart/
â”‚   â”‚           â”‚   â””â”€â”€ index.ts
â”‚   â”‚           â”œâ”€â”€ checkout/
â”‚   â”‚           â”‚   â””â”€â”€ index.ts
â”‚   â”‚           â””â”€â”€ evidence/
â”‚   â”‚               â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â””â”€â”€ web-app/                     # ç”¨æˆ·ç«¯ï¼ˆNext.jsï¼‰
â”‚       â”œâ”€â”€ Dockerfile
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ tsconfig.json
â”‚       â”œâ”€â”€ next.config.js
â”‚       â”œâ”€â”€ tailwind.config.ts
â”‚       â”œâ”€â”€ postcss.config.js
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ app/
â”‚           â”‚   â”œâ”€â”€ layout.tsx
â”‚           â”‚   â”œâ”€â”€ page.tsx
â”‚           â”‚   â””â”€â”€ globals.css
â”‚           â”œâ”€â”€ components/
â”‚           â”‚   â””â”€â”€ ui/             # shadcn/ui ç»„ä»¶
â”‚           â”œâ”€â”€ lib/
â”‚           â”‚   â””â”€â”€ utils.ts
â”‚           â””â”€â”€ store/
â”‚               â””â”€â”€ shopping.ts     # Zustand çŠ¶æ€ç®¡ç†
â”‚
â”œâ”€â”€ data/                            # æ•°æ®ç®¡é“
â”‚   â””â”€â”€ seeds/                       # ç§å­æ•°æ®
â”‚       â”œâ”€â”€ attributes.json
â”‚       â”œâ”€â”€ categories.json
â”‚       â”œâ”€â”€ compliance_rules.json
â”‚       â”œâ”€â”€ sample_aroc.json
â”‚       â””â”€â”€ import_seeds.py
â”‚
â”œâ”€â”€ infra/                           # åŸºç¡€è®¾æ–½
â”‚   â””â”€â”€ docker/
â”‚       â”œâ”€â”€ docker-compose.yml      # åŸºç¡€å¼€å‘ç¯å¢ƒ
â”‚       â”œâ”€â”€ init-db.sql             # æ•°æ®åº“åˆå§‹åŒ–
â”‚       â”œâ”€â”€ seed-data.sql           # ç§å­æ•°æ®
â”‚       â””â”€â”€ migrations/
â”‚           â”œâ”€â”€ 001_update_schema.sql
â”‚           â””â”€â”€ 002_enhance_rag.sql # ğŸ†• RAG å¢å¼º
â”‚
â”œâ”€â”€ scripts/                         # å¼€å‘è„šæœ¬
â”‚   â”œâ”€â”€ generate-sdk.sh
â”‚   â”œâ”€â”€ import-sample-data.py
â”‚   â”œâ”€â”€ sync-xoobay-products.ts     # ğŸ†• XOOBAY åŒæ­¥
â”‚   â””â”€â”€ test-xoobay-api.ts          # ğŸ†• API æµ‹è¯•
â”‚
â”œâ”€â”€ tools/                           # è¾…åŠ©å·¥å…·
â”‚   â””â”€â”€ mcp-gh-ci-jobs/             # GitHub CI MCP å·¥å…·
â”‚       â””â”€â”€ README.md
â”‚
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ ci.yml                   # CI/CD é…ç½®
â”‚
â”œâ”€â”€ .env.example                     # ğŸ†• ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ docker-compose.full.yml          # ğŸ†• å®Œæ•´ Docker Compose
â”œâ”€â”€ package.json                     # Monorepo æ ¹é…ç½®
â”œâ”€â”€ pnpm-workspace.yaml
â”œâ”€â”€ pnpm-lock.yaml
â”œâ”€â”€ tsconfig.base.json
â””â”€â”€ turbo.json                       # Turborepo é…ç½®
```

---

## ç»„ä»¶èŒè´£è¾¹ç•Œï¼ˆå¼ºåˆ¶ï¼‰

| ç»„ä»¶ | èŒè´£ | ç¦æ­¢ |
|------|------|------|
| `contracts/` | å®šä¹‰å·¥å…· schemaã€é”™è¯¯ç ã€æ•°æ®æ¨¡å‹ | ä¸å«ä¸šåŠ¡é€»è¾‘ |
| `agents/` | Agent ç¼–æ’ã€LLM è°ƒç”¨ã€çŠ¶æ€æœºã€ä»»åŠ¡æ‹†è§£ | ä¸ç›´æ¥è®¿é—®æ•°æ®åº“ï¼›å¼ºäº‹å®å¿…é¡»æ¥è‡ªå·¥å…· |
| `agents/src/server.py` | HTTP API æš´éœ² Agent åŠŸèƒ½ | ä¸åšä¸šåŠ¡å†³ç­– |
| `tool-gateway/` | Envelopeã€é‰´æƒã€å¹‚ç­‰ã€é™æµã€å®¡è®¡ã€trace | ä¸åšä¸šåŠ¡å†³ç­– |
| `mcp-servers/` | é¢†åŸŸæœåŠ¡ç¼–æ’ï¼Œè¾“å‡ºå¼ºäº‹å®ä¸ evidence | ä¸ç›´æ¥æš´éœ²ç»™å‰ç«¯ |
| `data/pipelines/` | ç¦»çº¿/å‡†å®æ—¶æ„å»º AROC/KG/ç´¢å¼• | ä¸ç»•å¼€è¯æ®ä¸ç‰ˆæœ¬ç®¡ç† |
| `web-app/` | ç”¨æˆ·äº¤äº’ã€å±•ç¤ºã€æ”¯ä»˜ç¡®è®¤ | ä¸ç›´æ¥è°ƒç”¨ Agent |

---

## Docker æœåŠ¡æ‹“æ‰‘

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ç”¨æˆ·å±‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    web-app (Next.js)                        â”‚   â”‚
â”‚  â”‚                       :3001                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Agent ç¼–æ’å±‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              agent (Python + LangGraph + FastAPI)           â”‚   â”‚
â”‚  â”‚                       :8000                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å·¥å…·ç½‘å…³å±‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                tool-gateway (Fastify)                       â”‚   â”‚
â”‚  â”‚                       :3000                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      core-mcp (SSE)       â”‚   â”‚    checkout-mcp (SSE)     â”‚
â”‚          :3010            â”‚   â”‚          :3011            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                               â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®å±‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   postgres (pgvector)   â”‚  â”‚         redis           â”‚          â”‚
â”‚  â”‚         :5433           â”‚  â”‚         :6379           â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## MVP æœ€å°å¯åŠ¨

MVP åªéœ€å¯åŠ¨ä»¥ä¸‹ç»„ä»¶ï¼š

```bash
# ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker compose -f docker-compose.full.yml up -d

# éªŒè¯æœåŠ¡çŠ¶æ€
docker compose -f docker-compose.full.yml ps
```

æœåŠ¡åˆ—è¡¨ï¼š
- âœ… postgres (5433) - æ•°æ®åº“
- âœ… redis (6379) - ç¼“å­˜
- âœ… tool-gateway (3000) - API ç½‘å…³
- âœ… core-mcp (3010) - æ ¸å¿ƒå·¥å…·
- âœ… checkout-mcp (3011) - ç»“ç®—å·¥å…·
- âœ… web-app (3001) - å‰ç«¯
- âœ… agent (8000) - Python Agent

---

## Monorepo å·¥å…·æ¨è

| å·¥å…· | ç”¨é€” |
|------|------|
| **pnpm** | TypeScript åŒ…ç®¡ç†ï¼ˆworkspaceï¼‰ |
| **Turborepo** | æ„å»ºç¼“å­˜ä¸ä»»åŠ¡ç¼–æ’ |
| **uv** æˆ– **poetry** | Python ä¾èµ–ç®¡ç† |
| **Docker Compose** | æœ¬åœ°å¼€å‘ä¸éƒ¨ç½² |

---

## Contract First å·¥ä½œæµ

```
1. åœ¨ contracts/ å®šä¹‰ OpenAPI / JSON Schema
       â†“
2. è¿è¡Œ scripts/generate-sdk.sh
       â†“
3. è‡ªåŠ¨ç”Ÿæˆï¼š
   - packages/contracts-ts/ï¼ˆTypeScript ç±»å‹ï¼‰
   - agents/src/models/ï¼ˆPydantic æ¨¡å‹ï¼‰
       â†“
4. MCP Server / Agent ä½¿ç”¨ç”Ÿæˆçš„ç±»å‹å¼€å‘
       â†“
5. CI è¿è¡Œ contract-checkï¼šç¡®ä¿å®ç°ä¸ schema ä¸€è‡´
```

---

## ç¯å¢ƒé…ç½®

é¡¹ç›®ä½¿ç”¨ `.env.example` ä½œä¸ºç¯å¢ƒå˜é‡æ¨¡æ¿ï¼š

```bash
# å¤åˆ¶æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®
nano .env
```

å…³é”®é…ç½®é¡¹ï¼š
- `OPENAI_API_KEY` - OpenAI API å¯†é’¥ï¼ˆå¿…éœ€ï¼‰
- `POSTGRES_PASSWORD` - æ•°æ®åº“å¯†ç 
- `REDIS_PASSWORD` - Redis å¯†ç 
- `XOOBAY_API_KEY` - XOOBAY API å¯†é’¥ï¼ˆå¯é€‰ï¼‰
